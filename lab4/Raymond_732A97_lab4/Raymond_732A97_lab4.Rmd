---
title: "Lab 4 732A97"
author: \emph{Raymond Sseguya}
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE, 
          fig.align = "center", size = 5)
```

# Question: Canonical correlation analysis by utilizing suitable software

## Data
```{r}
library(dplyr); library(knitr)

S <- as.matrix(read.table("P10-16.dat"))
```

![Assignment4](10p16.PNG)


\pagebreak

## a) Test at the 5% level if there is any association between the groups of variables.
```{r}
inverse_sqrtm <- function(M){
  stopifnot(is.matrix(M))
  
  U <- eigen(M)$vectors
  D <- diag(eigen(M)$values)
  # print ( U%*%D%*%solve(U) )  # should be same as M
  M_sqrt_inv <- U%*%solve(sqrt(D))%*%solve(U) 
  return(M_sqrt_inv)
}

# S; inverse_sqrtm(S)
S11=S[1:3,1:3]; S12=S[1:3,4:5]; S21=t(S[1:3,4:5]); S22=S[4:5,4:5]
CCM=inverse_sqrtm(S11)%*%S12%*%solve(S22)%*%S21%*%inverse_sqrtm(S11); CCM
squared_rhos <- eigen(CCM)$values; squared_rhos

test_statistic <- function(n,p,q, squared_rhos){
  -(n-1-0.5*(p+q+1))*log(prod(1-squared_rhos))  }
n = 46; p=3; q=2
t <- test_statistic(n=n, p=p, q=q, squared_rhos = squared_rhos); t
c <- qchisq(p=1-0.05, df=p*q); c
t > c
```
We REJECT the null hypothesis at 5% significance level. Therefore we can say that that is NO association between the groups of variables. The test statistic `r t` is GREATER than the critical value `r c`.

\pagebreak

## b) How many pairs of canonical variates are significant?
```{r}
options(digits=22); sqrt(squared_rhos)
```
There are two significant canonical correlations `r sqrt(squared_rhos[1:2])` because they are not very close to zero.


## c) Interpret the "significant" squared canonical correlations.
## Tip: Read section "Canonical Correlations as Generalizations of Other Correlation Coefficients".

Glucose intolerance and insulin response to oral glucose have a recognizable effect on relative weight and fasting plasma resistance. Patients who are glucose intolerant will tend to be fatter.


## d) Interpret the canonical variates by using the coefficients and suitable correlations.



## e) Are the "significant" canonical variates good summary measures of the respective data sets?
## Tip: Read section "Proportions of Explained Sample Variance".



## f) Give your opinion on the success of this canonical correlation analysis.

